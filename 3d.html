<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8>
		<title>My first Three.js app</title>
		<style>
			body { margin: 0; }
			canvas { width: 100%; height: 100% }
		</style>
		<script src="js/three.js"></script>
		<script src="js/algorithm.js"></script>
		<script src="js/model.js"></script>
	</head>
	<body>
	<script>
		/* 3D */
		function init_columns(numColumns) {
			var columnsModel = ColumnsModel(2, -numColumns);
			for(var i = 0; i < numColumns; i++) {
				columnsModel.create_column(Math.floor(Math.random() * (300)) + 1);
			}
			return columnsModel;
		}

		function add_all_to(scene, columns) {
			for(var i in columns) {
				scene.add(columns[i]);
			}
		}

		/* Start */
		var scene = new THREE.Scene();
		var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
		var renderer = new THREE.WebGLRenderer();
		renderer.setSize( window.innerWidth, window.innerHeight );
		document.body.appendChild( renderer.domElement );
		camera.position.z = 300;

		// models
		var columnsModel = init_columns(450);
		add_all_to(scene, columnsModel.columns);

		var quickSortGenerator = Algorithm.quick_sort(columnsModel.columns, 0, columnsModel.columns.length-1, swap, smaller_than);
		// var mergeSortGenerator = Algorithm.merge_sort(columnsModel.columns, move_to, smaller_than);

		(function render() {
			requestAnimationFrame( render );
			renderer.render( scene, camera );
			quickSortGenerator.next();
			columnsModel.justify_position();
		})();

		// key, user interaction
		let speed = 5;
		document.onkeypress = function(evt) {
			evt = evt || window.event;
			var charCode = evt.keyCode || evt.which;
			var charStr = String.fromCharCode(charCode);
			console.log(charStr);
			switch(charStr) {
				case 'a':
					camera.position.x -= speed;
					break;
				case 'd':
					camera.position.x += speed;
					break;
				case 'w':
					camera.position.y += speed;
					break;
				case 's':
					camera.position.y -= speed;
					break;
			}
		};
		camera.up = new THREE.Vector3(0,0,1);
		camera.lookAt(new THREE.Vector3(0,0,-1));
	</script>
	</body>
</html>
